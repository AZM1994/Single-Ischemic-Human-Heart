module load gcc/6.2.0
module load java/jdk-1.8u112
module load bwa/0.7.15
module load picard/2.8.0
module load samtools/1.3.1
module load pigz/2.3.4
module load python/2.7.12
module load openblas/0.2.19
#module load R/3.2.5
#module load R/3.4.1
#module load R/3.5.1
#module load R/3.6.1
module load R/4.0.1

#module load dev/python/2.7.10
#module load dev/gcc-4.8.5
#module load utils/zlib/1.2.8
#module load dev/openblas/0.2.14
#module load stats/R/3.3.1

samtools view -h $1 | python /n/data1/bch/genetics/lee/software/mapd/baslancnv/varbin.50k.bam.py $1.varbin.50k.txt $1.varbin.50k.stats.txt /n/data1/bch/genetics/lee/software/mapd/baslancnv/hg19.bin.boundaries.50k.bowtie.k50.sorted.txt /n/data1/bch/genetics/lee/software/mapd/baslancnv/hg19.chrom.sizes.txt
Rscript /n/data1/bch/genetics/lee/software/mapd/baslancnv/cbs.r $1 50k /n/data1/bch/genetics/lee/software/mapd/baslancnv/hg19.50k.k50.bad.bins.txt /n/data1/bch/genetics/lee/software/mapd/baslancnv/hg19.varbin.gc.content.50k.bowtie.k50.txt
Rscript /n/data1/bch/genetics/lee/software/mapd/baslancnv/copynumber.r $1.hg19.50k.k50.varbin > $1.hg19.50k.k50.varbin.copynumber.log
Rscript /n/data1/bch/genetics/lee/software/mapd/baslancnv/cal_mapd.r $1.hg19.50k.k50.varbin.data.copynumber.txt > $1.hg19.50k.k50.mapd
